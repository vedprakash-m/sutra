{"version":3,"names":["useState","useEffect","apiService","useAuth","useApi","apiCall","dependencies","cov_zferir0lg","b","f","state","setState","s","data","loading","error","token","fetchData","prev","setToken","result","Error","message","refetch","useAsyncAction","setLoading","setError","execute","action","errorMessage"],"sources":["/Users/vedprakashmishra/sutra/src/hooks/useApi.ts"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { apiService } from \"../services/api\";\nimport { useAuth } from \"../components/auth/AuthProvider\";\n\nexport interface UseApiState<T> {\n  data: T | null;\n  loading: boolean;\n  error: string | null;\n}\n\nexport function useApi<T>(\n  apiCall: () => Promise<T>,\n  dependencies: any[] = [],\n): UseApiState<T> & { refetch: () => Promise<void> } {\n  const [state, setState] = useState<UseApiState<T>>({\n    data: null,\n    loading: true,\n    error: null,\n  });\n\n  const { token } = useAuth();\n\n  const fetchData = async () => {\n    setState((prev) => ({ ...prev, loading: true, error: null }));\n\n    try {\n      // Set the auth token for API requests\n      if (token) {\n        apiService.setToken(token);\n      }\n\n      const result = await apiCall();\n      setState({\n        data: result,\n        loading: false,\n        error: null,\n      });\n    } catch (error) {\n      setState({\n        data: null,\n        loading: false,\n        error: error instanceof Error ? error.message : \"An error occurred\",\n      });\n    }\n  };\n\n  useEffect(() => {\n    if (token !== null) {\n      // Only fetch when auth state is determined\n      fetchData();\n    }\n  }, [token, ...dependencies]);\n\n  return {\n    ...state,\n    refetch: fetchData,\n  };\n}\n\nexport function useAsyncAction<T = any>() {\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const { token } = useAuth();\n\n  const execute = async (action: () => Promise<T>): Promise<T | null> => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      // Set the auth token for API requests\n      if (token) {\n        apiService.setToken(token);\n      }\n\n      const result = await action();\n      return result;\n    } catch (error) {\n      const errorMessage =\n        error instanceof Error ? error.message : \"An error occurred\";\n      setError(errorMessage);\n      throw error;\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return {\n    loading,\n    error,\n    execute,\n  };\n}\n"],"mappings":"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","ignoreList":[]}