{"version":3,"names":["cov_1doqv66wke","actualCoverage","s","exports","useAuth","AuthProvider","react_1","require","AuthContext","createContext","undefined","f","context","useContext","b","Error","children","user","setUser","useState","isLoading","setIsLoading","token","setToken","isAuthenticated","isAdmin","roles","includes","useEffect","savedUser","localStorage","getItem","savedToken","JSON","parse","login","email","isAdminUser","mockUser","id","name","mockToken","setItem","stringify","error","console","logout","removeItem","value","jsx_runtime_1","jsx","Provider"],"sources":["/Users/vedprakashmishra/sutra/src/components/auth/AuthProvider.tsx"],"sourcesContent":["import {\n  createContext,\n  useContext,\n  ReactNode,\n  useState,\n  useEffect,\n} from \"react\";\n\ninterface User {\n  id: string;\n  email: string;\n  name: string;\n  roles: string[];\n}\n\ninterface AuthContextType {\n  user: User | null;\n  isAuthenticated: boolean;\n  isLoading: boolean;\n  login: (email?: string, isAdmin?: boolean) => Promise<void>;\n  logout: () => Promise<void>;\n  isAdmin: boolean;\n  token: string | null;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error(\"useAuth must be used within an AuthProvider\");\n  }\n  return context;\n}\n\ninterface AuthProviderProps {\n  children: ReactNode;\n}\n\nexport function AuthProvider({ children }: AuthProviderProps) {\n  const [user, setUser] = useState<User | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [token, setToken] = useState<string | null>(null);\n\n  const isAuthenticated = !!user;\n  const isAdmin = user?.roles.includes(\"admin\") ?? false;\n\n  // Initialize auth state from localStorage\n  useEffect(() => {\n    const savedUser = localStorage.getItem(\"sutra_user\");\n    const savedToken = localStorage.getItem(\"sutra_token\");\n\n    if (savedUser && savedToken) {\n      setUser(JSON.parse(savedUser));\n      setToken(savedToken);\n    }\n    setIsLoading(false);\n  }, []);\n\n  const login = async (email = \"user@sutra.ai\", isAdminUser = false) => {\n    setIsLoading(true);\n    try {\n      // Development mode authentication\n      const mockUser: User = {\n        id: isAdminUser ? \"mock-admin-id\" : \"mock-user-id\",\n        email: isAdminUser ? \"admin@sutra.ai\" : email,\n        name: isAdminUser ? \"Development Admin\" : \"Development User\",\n        roles: isAdminUser ? [\"admin\", \"user\"] : [\"user\"],\n      };\n\n      const mockToken = isAdminUser ? \"mock-admin-token\" : \"mock-token\";\n\n      setUser(mockUser);\n      setToken(mockToken);\n\n      // Save to localStorage\n      localStorage.setItem(\"sutra_user\", JSON.stringify(mockUser));\n      localStorage.setItem(\"sutra_token\", mockToken);\n    } catch (error) {\n      console.error(\"Login failed:\", error);\n      throw error;\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const logout = async () => {\n    setUser(null);\n    setToken(null);\n    localStorage.removeItem(\"sutra_user\");\n    localStorage.removeItem(\"sutra_token\");\n  };\n\n  const value: AuthContextType = {\n    user,\n    isAuthenticated,\n    isLoading,\n    login,\n    logout,\n    isAdmin,\n    token,\n  };\n\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAwCS;IAAAA,cAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,cAAA;AAAAA,cAAA,GAAAE,CAAA;;;;;;AAbTC,OAAA,CAAAC,OAAA,GAAAA,OAAA;AAMC;AAAAJ,cAAA,GAAAE,CAAA;AAMDC,OAAA,CAAAE,YAAA,GAAAA,YAAA;;;;AAvCA,MAAAC,OAAA;AAAA;AAAA,CAAAN,cAAA,GAAAE,CAAA,OAAAK,OAAA;AAyBA,MAAMC,WAAW;AAAA;AAAA,CAAAR,cAAA,GAAAE,CAAA,OAAG,IAAAI,OAAA,CAAAG,aAAa,EAA8BC,SAAS,CAAC;AAEzE,SAAgBN,OAAOA,CAAA;EAAA;EAAAJ,cAAA,GAAAW,CAAA;EACrB,MAAMC,OAAO;EAAA;EAAA,CAAAZ,cAAA,GAAAE,CAAA,OAAG,IAAAI,OAAA,CAAAO,UAAU,EAACL,WAAW,CAAC;EAAC;EAAAR,cAAA,GAAAE,CAAA;EACxC,IAAIU,OAAO,KAAKF,SAAS,EAAE;IAAA;IAAAV,cAAA,GAAAc,CAAA;IAAAd,cAAA,GAAAE,CAAA;IACzB,MAAM,IAAIa,KAAK,CAAC,6CAA6C,CAAC;EAChE,CAAC;EAAA;EAAA;IAAAf,cAAA,GAAAc,CAAA;EAAA;EAAAd,cAAA,GAAAE,CAAA;EACD,OAAOU,OAAO;AAChB;AAMA,SAAgBP,YAAYA,CAAC;EAAEW;AAAQ,CAAqB;EAAA;EAAAhB,cAAA,GAAAW,CAAA;EAC1D,MAAM,CAACM,IAAI,EAAEC,OAAO,CAAC;EAAA;EAAA,CAAAlB,cAAA,GAAAE,CAAA,QAAG,IAAAI,OAAA,CAAAa,QAAQ,EAAc,IAAI,CAAC;EACnD,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC;EAAA;EAAA,CAAArB,cAAA,GAAAE,CAAA,QAAG,IAAAI,OAAA,CAAAa,QAAQ,EAAC,IAAI,CAAC;EAChD,MAAM,CAACG,KAAK,EAAEC,QAAQ,CAAC;EAAA;EAAA,CAAAvB,cAAA,GAAAE,CAAA,QAAG,IAAAI,OAAA,CAAAa,QAAQ,EAAgB,IAAI,CAAC;EAEvD,MAAMK,eAAe;EAAA;EAAA,CAAAxB,cAAA,GAAAE,CAAA,QAAG,CAAC,CAACe,IAAI;EAC9B,MAAMQ,OAAO;EAAA;EAAA,CAAAzB,cAAA,GAAAE,CAAA;EAAG;EAAA,CAAAF,cAAA,GAAAc,CAAA,UAAAG,IAAI,EAAES,KAAK,CAACC,QAAQ,CAAC,OAAO,CAAC;EAAA;EAAA,CAAA3B,cAAA,GAAAc,CAAA,UAAI,KAAK;EAEtD;EAAA;EAAAd,cAAA,GAAAE,CAAA;EACA,IAAAI,OAAA,CAAAsB,SAAS,EAAC,MAAK;IAAA;IAAA5B,cAAA,GAAAW,CAAA;IACb,MAAMkB,SAAS;IAAA;IAAA,CAAA7B,cAAA,GAAAE,CAAA,QAAG4B,YAAY,CAACC,OAAO,CAAC,YAAY,CAAC;IACpD,MAAMC,UAAU;IAAA;IAAA,CAAAhC,cAAA,GAAAE,CAAA,QAAG4B,YAAY,CAACC,OAAO,CAAC,aAAa,CAAC;IAAC;IAAA/B,cAAA,GAAAE,CAAA;IAEvD;IAAI;IAAA,CAAAF,cAAA,GAAAc,CAAA,UAAAe,SAAS;IAAA;IAAA,CAAA7B,cAAA,GAAAc,CAAA,UAAIkB,UAAU,GAAE;MAAA;MAAAhC,cAAA,GAAAc,CAAA;MAAAd,cAAA,GAAAE,CAAA;MAC3BgB,OAAO,CAACe,IAAI,CAACC,KAAK,CAACL,SAAS,CAAC,CAAC;MAAC;MAAA7B,cAAA,GAAAE,CAAA;MAC/BqB,QAAQ,CAACS,UAAU,CAAC;IACtB,CAAC;IAAA;IAAA;MAAAhC,cAAA,GAAAc,CAAA;IAAA;IAAAd,cAAA,GAAAE,CAAA;IACDmB,YAAY,CAAC,KAAK,CAAC;EACrB,CAAC,EAAE,EAAE,CAAC;EAAC;EAAArB,cAAA,GAAAE,CAAA;EAEP,MAAMiC,KAAK,GAAG,MAAAA,CAAOC,KAAK;EAAA;EAAA,CAAApC,cAAA,GAAAc,CAAA,UAAG,eAAe,GAAEuB,WAAW;EAAA;EAAA,CAAArC,cAAA,GAAAc,CAAA,UAAG,KAAK,MAAI;IAAA;IAAAd,cAAA,GAAAW,CAAA;IAAAX,cAAA,GAAAE,CAAA;IACnEmB,YAAY,CAAC,IAAI,CAAC;IAAC;IAAArB,cAAA,GAAAE,CAAA;IACnB,IAAI;MACF;MACA,MAAMoC,QAAQ;MAAA;MAAA,CAAAtC,cAAA,GAAAE,CAAA,QAAS;QACrBqC,EAAE,EAAEF,WAAW;QAAA;QAAA,CAAArC,cAAA,GAAAc,CAAA,UAAG,eAAe;QAAA;QAAA,CAAAd,cAAA,GAAAc,CAAA,UAAG,cAAc;QAClDsB,KAAK,EAAEC,WAAW;QAAA;QAAA,CAAArC,cAAA,GAAAc,CAAA,UAAG,gBAAgB;QAAA;QAAA,CAAAd,cAAA,GAAAc,CAAA,UAAGsB,KAAK;QAC7CI,IAAI,EAAEH,WAAW;QAAA;QAAA,CAAArC,cAAA,GAAAc,CAAA,UAAG,mBAAmB;QAAA;QAAA,CAAAd,cAAA,GAAAc,CAAA,UAAG,kBAAkB;QAC5DY,KAAK,EAAEW,WAAW;QAAA;QAAA,CAAArC,cAAA,GAAAc,CAAA,UAAG,CAAC,OAAO,EAAE,MAAM,CAAC;QAAA;QAAA,CAAAd,cAAA,GAAAc,CAAA,UAAG,CAAC,MAAM,CAAC;OAClD;MAED,MAAM2B,SAAS;MAAA;MAAA,CAAAzC,cAAA,GAAAE,CAAA,QAAGmC,WAAW;MAAA;MAAA,CAAArC,cAAA,GAAAc,CAAA,WAAG,kBAAkB;MAAA;MAAA,CAAAd,cAAA,GAAAc,CAAA,WAAG,YAAY;MAAC;MAAAd,cAAA,GAAAE,CAAA;MAElEgB,OAAO,CAACoB,QAAQ,CAAC;MAAC;MAAAtC,cAAA,GAAAE,CAAA;MAClBqB,QAAQ,CAACkB,SAAS,CAAC;MAEnB;MAAA;MAAAzC,cAAA,GAAAE,CAAA;MACA4B,YAAY,CAACY,OAAO,CAAC,YAAY,EAAET,IAAI,CAACU,SAAS,CAACL,QAAQ,CAAC,CAAC;MAAC;MAAAtC,cAAA,GAAAE,CAAA;MAC7D4B,YAAY,CAACY,OAAO,CAAC,aAAa,EAAED,SAAS,CAAC;IAChD,CAAC,CAAC,OAAOG,KAAK,EAAE;MAAA;MAAA5C,cAAA,GAAAE,CAAA;MACd2C,OAAO,CAACD,KAAK,CAAC,eAAe,EAAEA,KAAK,CAAC;MAAC;MAAA5C,cAAA,GAAAE,CAAA;MACtC,MAAM0C,KAAK;IACb,CAAC,SAAS;MAAA;MAAA5C,cAAA,GAAAE,CAAA;MACRmB,YAAY,CAAC,KAAK,CAAC;IACrB;EACF,CAAC;EAAC;EAAArB,cAAA,GAAAE,CAAA;EAEF,MAAM4C,MAAM,GAAG,MAAAA,CAAA,KAAW;IAAA;IAAA9C,cAAA,GAAAW,CAAA;IAAAX,cAAA,GAAAE,CAAA;IACxBgB,OAAO,CAAC,IAAI,CAAC;IAAC;IAAAlB,cAAA,GAAAE,CAAA;IACdqB,QAAQ,CAAC,IAAI,CAAC;IAAC;IAAAvB,cAAA,GAAAE,CAAA;IACf4B,YAAY,CAACiB,UAAU,CAAC,YAAY,CAAC;IAAC;IAAA/C,cAAA,GAAAE,CAAA;IACtC4B,YAAY,CAACiB,UAAU,CAAC,aAAa,CAAC;EACxC,CAAC;EAED,MAAMC,KAAK;EAAA;EAAA,CAAAhD,cAAA,GAAAE,CAAA,QAAoB;IAC7Be,IAAI;IACJO,eAAe;IACfJ,SAAS;IACTe,KAAK;IACLW,MAAM;IACNrB,OAAO;IACPH;GACD;EAAC;EAAAtB,cAAA,GAAAE,CAAA;EAEF,OAAO,IAAA+C,aAAA,CAAAC,GAAA,EAAC1C,WAAW,CAAC2C,QAAQ;IAACH,KAAK,EAAEA,KAAK;IAAAhC,QAAA,EAAGA;EAAQ,EAAwB;AAC9E","ignoreList":[]}